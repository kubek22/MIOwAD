#%%

f = [ReLU, ReLU, lambda x: x]
net = Net(n_neurons=[20, 20, 1], n_inputs=1, functions=f, param_init='xavier')

# w = read("weights3_2.txt")
# b = read("biases3_2.txt")
# net = Net(weights=w, biases=b, functions=f)

epoch = 0

#%%

import warnings 
warnings.filterwarnings('ignore') 

start = time.time()

current_MSE = math.inf
while current_MSE > 40:
    net.fit(x_train_scaled, y_train_scaled, batch_size=1, epochs=1, alpha=0.003)
    epoch += 1
    current_MSE = count_MSE(net, x_test_scaled, y_test, scaler_y)
    print()
    print(current_MSE)
    print(epoch)
    
end = time.time()


#%%

predictions = []
for x in x_test_scaled:
    predictions.append(net.predict(x))
    
predictions = scaler_y.inverse_transform(np.array([predictions]))[0]

plt.plot(x_test, y_test, 'o')
plt.plot(x_test, predictions, 'o')
plt.show()

print(current_MSE)
print("Time elapsed: ", end - start)

#%% old

print(net.get_all_weights())

# [array([[-1.05138532],
#         [ 0.83726556],
#         [ 0.68457678],
#         [-1.91571445],
#         [-0.49708878],
#         [ 0.04421551],
#         [-1.00298153],
#         [-1.22246513],
#         [-1.0400568 ],
#         [-0.12380225],
#         [ 0.42294616],
#         [ 0.56589709],
#         [-2.29411064],
#         [ 0.51498043],
#         [ 0.09726216],
#         [ 0.04158089],
#         [-2.39207084],
#         [ 0.16810453],
#         [ 0.85678246],
#         [ 0.71869622]]),
#  array([[-3.21933317e-01,  1.71018623e-01,  4.64936799e-02,
#          -4.71014294e-01,  1.58276822e-01,  5.16136313e-01,
#           4.18563929e-02, -2.57177864e-01, -1.00624429e-01,
#          -2.61040733e-02,  7.96945898e-02,  3.10255763e-01,
#           5.87549544e-01, -1.73296297e-01,  2.29990879e-01,
#           2.45284368e-01, -1.90514858e+00, -1.43489542e-01,
#           1.91658495e-01,  5.81706732e-01],
#         [-1.01378778e+00,  5.18582459e-01,  4.41950306e-01,
#          -1.44729666e+00, -4.84013245e-01,  2.98915096e-01,
#          -5.92623870e-01, -1.08366863e+00, -5.90770010e-01,
#          -2.73957621e-01, -4.71843083e-02,  4.78544845e-01,
#           7.45342526e-02, -8.20902149e-02, -2.02600396e-01,
#           3.73000501e-01, -1.44807247e-01,  2.85076939e-01,
#           3.97877489e-01,  1.83057837e-01],
#         [-1.39087792e-03,  3.53457380e-01,  3.08028681e-01,
#           2.08746195e-01, -2.40197159e-01,  1.10027461e-01,
#           2.28513496e-01,  4.98624395e-01, -1.53226613e-01,
#           1.31379403e-01, -1.03756338e-01,  4.72830912e-01,
#          -5.80273163e-01, -2.03116259e-02,  1.29426321e-01,
#           1.34981203e-02,  5.49436002e-03, -3.49564002e-01,
#          -9.33594972e-02,  3.27755808e-01],
#         [ 2.26197828e-01,  5.32211871e-01,  6.86250584e-02,
#          -1.89252021e-01,  9.62211051e-02,  1.22501185e-02,
#           1.40278442e-01,  3.85480795e-01, -1.04926030e-01,
#          -3.59234143e-01,  1.74889422e-01,  4.09870606e-01,
#          -6.51661098e-01,  1.00058912e-01, -4.96661163e-02,
#          -2.42276147e-01,  7.45873771e-01, -2.22617072e-01,
#          -2.69610025e-01,  4.30376970e-01],
#         [-2.75658202e-01, -1.57791093e-01, -3.32937824e-01,
#           8.33021410e-02,  2.19498626e-03,  1.81559329e-01,
#           1.73837689e-01, -7.71523336e-03, -1.74074964e-01,
#           2.73386905e-01, -3.07684767e-01,  2.25390714e-01,
#          -2.56695256e-01, -3.02424930e-01, -5.41770302e-02,
#          -3.55986082e-01, -1.69217954e-01, -2.93217054e-01,
#           8.34986866e-02, -3.37701073e-01],
#         [ 3.02588423e-01, -1.00999012e-01, -1.83047851e-01,
#          -1.20370946e-01,  2.56275145e-01,  8.69000444e-02,
#          -2.37995395e-01, -1.36446256e-01,  1.50853295e-01,
#           1.08054439e-01,  1.43384520e-01, -1.45916330e-01,
#           3.69561162e-02,  9.55661959e-02, -1.27429623e-01,
#           1.78543556e-01, -3.23202546e-01, -3.17463991e-01,
#          -2.33072210e-01, -1.30630135e-01],
#         [ 2.14518908e-01,  1.64227387e-01,  2.57598363e-01,
#          -5.49888172e-01,  2.10435182e-01,  2.17549593e-01,
#          -4.68560300e-01,  3.36526075e-01, -2.84210031e-01,
#           2.26631298e-03,  5.69077501e-01,  4.98407620e-01,
#          -7.00054680e-01, -1.38372641e-01, -1.75523538e-01,
#           4.21242379e-01,  1.20689301e+00, -1.45826132e-01,
#           6.30982778e-02,  5.27348073e-01],
#         [-1.21113665e-01, -2.97687276e-02, -3.20184285e-01,
#          -3.99133198e-02, -3.37037157e-01,  8.81321653e-03,
#          -5.56639759e-02,  2.33019506e-01, -1.39583924e-01,
#           2.85774727e-01, -2.67159680e-01, -2.43431051e-01,
#          -2.10273100e-01,  3.83304942e-01, -3.21888641e-01,
#          -6.74897121e-02, -2.12991169e-01, -1.80852822e-01,
#          -2.32185549e-01,  2.97005851e-03],
#         [-1.60860528e-01, -2.63971513e-01, -3.73791019e-01,
#          -4.42222290e-01, -1.59476076e-01,  1.53062999e-01,
#           3.02384364e-01, -3.16631995e-01,  1.56726310e-01,
#           1.42373184e-01,  9.87927898e-02,  1.62885431e-01,
#           2.13439716e-01, -6.72572942e-02, -2.28541431e-01,
#           2.96863088e-01,  1.51180008e-01, -6.98378708e-02,
#           3.61805543e-01, -2.09841842e-01],
#         [-9.35038041e-02, -8.45626068e-01, -8.60440392e-01,
#           1.61264016e-01, -2.94554894e-01,  4.81001045e-02,
#           2.39545544e-01,  1.61736279e-01,  8.94232644e-02,
#          -4.27673011e-01, -7.49652829e-01, -2.76482189e-01,
#          -6.09296602e-03, -7.09422559e-01, -3.11967660e-01,
#          -4.31804505e-01,  3.94979777e-01, -7.62900916e-02,
#           1.05479583e-02, -6.14081376e-01],
#         [ 1.28345588e-01,  5.93331491e-01,  3.03464063e-02,
#           2.43275794e-01,  3.28458819e-01,  1.42129868e-01,
#           2.19941377e-01, -1.15296889e-01,  1.29503065e-01,
#          -2.53325174e-01,  2.60046880e-01,  9.41561397e-02,
#          -7.65249850e-01,  3.74161590e-01,  5.15605943e-01,
#           4.05994040e-01,  2.43313896e-01,  2.35766648e-01,
#           1.71929899e-01,  3.92517262e-01],
#         [-2.74011018e-01,  9.01793782e-02, -6.62689810e-03,
#           2.88502328e-02, -2.24351287e-01, -1.42943724e-01,
#           2.35227976e-01,  2.47333269e-01, -3.64527089e-01,
#          -3.95383522e-01,  2.71325503e-01, -1.03776244e-01,
#           1.82715222e-01,  2.59692918e-01, -3.27929889e-01,
#          -2.70962937e-01,  2.95912473e-01, -2.29421447e-02,
#           1.72118459e-01, -4.42168376e-02],
#         [ 1.23311763e-01,  2.61893562e-01,  2.04177832e-01,
#          -3.08837951e-01,  3.62916616e-01, -1.25323057e-01,
#           6.09463485e-02,  6.92708250e-02,  1.25768921e-01,
#          -3.02113129e-01, -2.09657482e-01,  3.31490254e-01,
#          -2.00687074e+00,  1.93253739e-01, -3.03405543e-01,
#          -4.48114877e-01,  1.42357053e-02,  2.72327379e-01,
#           7.59295960e-01,  8.81778065e-02],
#         [-1.27813566e-01, -9.35759586e-02,  6.13502735e-02,
#           1.63165703e-01,  2.65101917e-04,  3.16442688e-01,
#          -8.28355031e-02,  2.94720621e-01,  2.31837191e-01,
#          -1.18897362e-01, -4.80651891e-02,  2.29870527e-01,
#          -4.95927537e-01,  4.42855877e-01,  1.80295717e-02,
#           4.50285761e-01,  2.04191501e-01, -1.74876593e-01,
#          -3.94449951e-01, -2.31438049e-02],
#         [-8.43263649e-02,  1.43970441e-01,  9.59540937e-02,
#           5.68857927e-02, -4.72742046e-02, -2.14276218e-01,
#          -1.34141201e-01, -1.96343453e-01,  1.55161855e-01,
#           3.16476677e-01, -3.16074477e-01, -1.62079172e-01,
#          -2.12565730e-01,  1.46941191e-01,  3.39294849e-01,
#          -7.59729291e-02,  6.75259869e-02, -1.81405161e-01,
#           7.90207885e-02,  3.63576892e-01],
#         [ 2.23268146e-01,  5.12548420e-01, -1.75260572e-01,
#          -3.57758309e-01, -3.73541870e-01, -2.41863004e-01,
#          -1.64368946e-01, -3.32663818e-01, -3.04538761e-01,
#          -2.44679663e-01,  3.20544024e-01,  3.16502597e-01,
#           1.56009995e-01,  3.61254308e-01,  2.17239150e-01,
#           7.50269536e-02, -1.03273303e-01,  2.31779588e-01,
#           2.39272093e-02,  2.46573603e-01],
#         [ 2.25320278e-01, -4.00823542e-01,  1.15238057e-01,
#           1.26013220e-01, -5.66971235e-02,  3.10127930e-01,
#          -1.03731719e-01,  5.84196943e-01, -4.73592698e-01,
#          -1.80129689e-01,  9.36000252e-02,  1.74681293e-01,
#          -1.80966162e-01, -3.96732355e-01, -1.29945783e-01,
#           4.17258625e-01,  5.44050373e-02, -1.09678040e-01,
#          -3.40512043e-01,  8.26079419e-02],
#         [ 1.65422273e-01, -2.41458340e-01, -8.99016597e-02,
#           1.17080664e-01,  5.76120435e-02, -3.28954364e-01,
#           5.39762654e-02,  1.23602679e-01, -3.94793646e-02,
#          -3.04922688e-01,  2.83568044e-01, -9.33981491e-02,
#          -3.95419220e-01,  3.21408985e-01,  9.95075645e-03,
#           5.21099121e-02, -2.56087368e-01, -2.71646204e-02,
#           2.34729794e-01, -3.48633763e-01],
#         [-6.13025970e-01,  3.09044596e-01,  4.44097947e-02,
#          -1.43767537e+00, -3.97003072e-01, -7.65798451e-03,
#          -9.09310311e-01, -9.67112519e-01, -8.56892455e-01,
#           3.23841720e-01, -6.57698080e-02,  2.44690883e-01,
#           1.31868032e+00,  2.12968799e-01,  1.59668297e-01,
#          -4.99353965e-02,  3.05185277e-01, -2.32711403e-01,
#           4.27116935e-01, -5.46920239e-02],
#         [ 2.85586626e-01,  2.96423599e-01,  3.69112746e-01,
#          -4.06873936e-01, -3.26828652e-01,  4.00794743e-01,
#           2.16745409e-01, -2.30809760e-01, -3.11148190e-01,
#           1.16073046e-01, -1.15119508e-01,  2.67462004e-01,
#          -2.21074469e-02, -3.67788134e-02,  1.08144095e-01,
#          -2.02098420e-01,  3.23665558e-01, -1.18814834e-01,
#          -2.72939094e-01,  3.52357056e-01]]),
#  array([[ 1.6281908 ,  2.13912917, -0.26048014, -0.88015262, -0.49406493,
#           0.25633146, -1.43067685, -0.49647338, -0.31793346,  1.64720794,
#          -0.48145999, -0.23669336, -2.03539728, -0.25017203, -0.16438636,
#           0.07736432,  0.07324863, -0.52292816,  2.15702902, -0.53350741]])]

print(net.get_all_biases())

# [array([ 0.74892238,  0.70916508,  0.57990269,  0.52455085,  0.16811821,
#          0.26960469,  0.29657115,  0.86432697,  0.29534682,  0.28834324,
#          0.47698902,  0.47891934,  1.43039235,  0.43579012,  0.43328286,
#          0.57116477, -0.47465358,  0.12854503, -0.11266172,  0.60817023]),
#  array([ 0.35638943,  0.26333104,  0.49758106,  0.66393483,  0.02127478,
#          0.44612961,  0.93756419,  0.3042482 ,  0.21147274, -0.37769295,
#          0.73058156, -0.03017258, -0.25748856,  0.23984612,  0.88479025,
#          0.55369046,  0.21809074,  0.19057066,  0.38074633,  0.67269305]),
#  array([0.4010091])]

